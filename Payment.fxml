<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<StackPane xmlns="http://javafx.com/javafx/25" 
           xmlns:fx="http://javafx.com/fxml/1" 
           fx:controller="com.newfoundsoftware.pos.PaymentController"
           prefHeight="700" prefWidth="700">

    <!-- ============================================ -->
    <!-- STEP 1: INVOICE VIEW (Shows first) -->
    <!-- ============================================ -->
    <VBox fx:id="invoicePane" spacing="15" 
          style="-fx-background-color: white; -fx-padding: 30; -fx-border-color: #ddd; -fx-border-width: 2;">
        
        <!-- Header -->
        <HBox alignment="CENTER_LEFT" spacing="20">
            <children>
                <VBox>
                    <children>
                        <Label text="SHEGLAM COSMETICS" style="-fx-font-size: 18; -fx-font-weight: bold;" />
                        <Label text="USTP Cagayan de Oro" style="-fx-font-size: 11;" />
                        <Label text="Cagayan de Oro City, Misamis Oriental" style="-fx-font-size: 11;" />
                        <Label text="0922-553-1465" style="-fx-font-size: 11;" />
                    </children>
                </VBox>
                
                <Region HBox.hgrow="ALWAYS" />
                
                <Label text="INVOICE" style="-fx-font-size: 36; -fx-font-weight: bold; -fx-text-fill: #92709A;" />
            </children>
        </HBox>
        
        <Separator />
        
        <!-- Invoice Info -->
        <HBox alignment="CENTER" spacing="20">
            <children>
                <Label fx:id="lblInvoiceNumber" text="Invoice No: 000000" style="-fx-font-weight: bold; -fx-font-size: 12;" />
                <Label text="-" />
                <Label fx:id="lblInvoiceDate" text="Date: " style="-fx-font-size: 12;" />
            </children>
        </HBox>
        
        <Separator />
        
        <!-- Items Table -->
        <TableView fx:id="tableInvoiceItems" VBox.vgrow="ALWAYS" style="-fx-font-size: 12;" prefHeight="300">
            <columns>
                <TableColumn fx:id="colInvoiceQty" text="QTY" prefWidth="80" />
                <TableColumn fx:id="colInvoiceDescription" text="DESCRIPTION" prefWidth="350" />
                <TableColumn fx:id="colInvoiceUnitPrice" text="UNIT PRICE" prefWidth="100" />
                <TableColumn fx:id="colInvoiceTotal" text="TOTAL" prefWidth="120" />
            </columns>
        </TableView>
        
        <Separator />
        
        <!-- Totals Section -->
        <HBox>
            <children>
                <Region HBox.hgrow="ALWAYS" />
                <VBox spacing="10" prefWidth="250">
                    <children>
                        <HBox>
                            <children>
                                <Label text="SUB TOTAL:" HBox.hgrow="ALWAYS" style="-fx-font-size: 14;" />
                                <Label fx:id="lblInvoiceSubTotal" text="₱0.00" style="-fx-font-size: 14; -fx-font-weight: bold;" />
                            </children>
                        </HBox>
                        <HBox>
                            <children>
                                <Label text="VAT (12%):" HBox.hgrow="ALWAYS" style="-fx-font-size: 14;" />
                                <Label fx:id="lblInvoiceVAT" text="₱0.00" style="-fx-font-size: 14; -fx-font-weight: bold;" />
                            </children>
                        </HBox>
                        <Separator />
                        <HBox>
                            <children>
                                <Label text="GRAND TOTAL:" HBox.hgrow="ALWAYS" style="-fx-font-size: 16; -fx-font-weight: bold;" />
                                <Label fx:id="lblInvoiceGrandTotal" text="₱0.00" style="-fx-font-size: 16; -fx-font-weight: bold; -fx-text-fill: #92709A;" />
                            </children>
                        </HBox>
                    </children>
                </VBox>
            </children>
        </HBox>
        
        <Separator />
        
        <!-- Pay Button -->
        <HBox alignment="CENTER" spacing="20">
            <children>
                <Button text="Cancel" onAction="#handleCancel" prefWidth="150" prefHeight="40"
                        style="-fx-background-color: #f44336; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;" />
                <Button text="PROCEED TO PAYMENT" onAction="#handleProceedToPayment" prefWidth="200" prefHeight="40"
                        style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;" />
            </children>
        </HBox>
        
    </VBox>

    <!-- ============================================ -->
    <!-- STEP 2: PAYMENT INPUT (Shows after clicking Pay) -->
    <!-- ============================================ -->
    <VBox fx:id="paymentPane" spacing="20" visible="false" managed="false"
          style="-fx-background-color: white; -fx-padding: 40; -fx-border-color: #92709A; -fx-border-width: 3; -fx-background-radius: 10; -fx-border-radius: 10;"
          alignment="CENTER" prefWidth="400" prefHeight="350">
        
        <children>
            <Label text="ENTER PAYMENT AMOUNT" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #92709A;" />
            
            <Separator prefWidth="350" />
            
            <VBox spacing="10" alignment="CENTER">
                <children>
                    <Label text="Total Amount:" style="-fx-font-size: 16; -fx-font-weight: bold;" />
                    <Label fx:id="lblPaymentTotal" text="₱0.00" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #4CAF50;" />
                </children>
            </VBox>
            
            <Separator prefWidth="350" />
            
            <VBox spacing="10" alignment="CENTER">
                <children>
                    <Label text="Amount Paid:" style="-fx-font-size: 14; -fx-font-weight: bold;" />
                    <TextField fx:id="txtAmountPaid" promptText="Enter amount..." prefWidth="250" prefHeight="40"
                               style="-fx-font-size: 18; -fx-alignment: center; -fx-border-color: #92709A; -fx-border-width: 2;" />
                </children>
            </VBox>
            
            <VBox spacing="5" alignment="CENTER">
                <children>
                    <Label text="Change:" style="-fx-font-size: 12; -fx-text-fill: #666;" />
                    <Label fx:id="lblChangePreview" text="₱0.00" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: green;" />
                </children>
            </VBox>
            
            <Separator prefWidth="350" />
            
            <HBox spacing="20" alignment="CENTER">
                <children>
                    <Button text="Back" onAction="#handleBackToInvoice" prefWidth="120" prefHeight="40"
                            style="-fx-background-color: #9E9E9E; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;" />
                    <Button text="CONFIRM PAYMENT" onAction="#handleConfirmPayment" prefWidth="180" prefHeight="40"
                            style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;" />
                </children>
            </HBox>
        </children>
        
    </VBox>

    <!-- ============================================ -->
    <!-- STEP 3: RECEIPT (Shows after payment confirmation) -->
    <!-- ============================================ -->
    <VBox fx:id="receiptPane" visible="false" managed="false" spacing="10" 
          style="-fx-background-color: white; -fx-padding: 30; -fx-border-color: #ddd; -fx-border-width: 2;"
          alignment="CENTER">
        
        <children>
            <!-- Receipt Header -->
            <VBox spacing="2" alignment="CENTER">
                <children>
                    <Label text="SHEGLAM COSMETICS" style="-fx-font-weight: bold; -fx-font-size: 16; -fx-font-family: 'Courier New';" />
                    <Label text="USTP Cagayan de Oro" style="-fx-font-family: 'Courier New'; -fx-font-size: 11;" />
                    <Label text="Cagayan de Oro City, Misamis Oriental" style="-fx-font-family: 'Courier New'; -fx-font-size: 11;" />
                    <Label text="0922-553-1465" style="-fx-font-family: 'Courier New'; -fx-font-size: 11;" />
                    <Label fx:id="lblReceiptNumber" text="Receipt No: 000000" style="-fx-font-family: 'Courier New'; -fx-font-size: 11; -fx-font-weight: bold;" />
                    <Label fx:id="lblReceiptDate" text="Date: " style="-fx-font-family: 'Courier New'; -fx-font-size: 11;" />
                </children>
            </VBox>
            
            <Separator prefWidth="600" />
            
            <!-- Receipt Items Table -->
            <TableView fx:id="tableReceiptItems" prefHeight="300" prefWidth="600" 
                       style="-fx-font-family: 'Courier New'; -fx-font-size: 11;">
                <columns>
                    <TableColumn fx:id="colReceiptQty" text="QTY" prefWidth="80" />
                    <TableColumn fx:id="colReceiptDescription" text="ITEM" prefWidth="300" />
                    <TableColumn fx:id="colReceiptUnitPrice" text="PRICE" prefWidth="100" />
                    <TableColumn fx:id="colReceiptTotal" text="TOTAL" prefWidth="120" />
                </columns>
            </TableView>
            
            <Separator prefWidth="600" />
            
            <!-- Receipt Totals -->
            <VBox spacing="8" style="-fx-font-family: 'Courier New'; -fx-font-size: 12;" prefWidth="600">
                <children>
                    <HBox>
                        <children>
                            <Label text="Sub Total:" HBox.hgrow="ALWAYS" />
                            <Label fx:id="lblReceiptSubTotal" text="₱0.00" style="-fx-font-weight: bold;" />
                        </children>
                    </HBox>
                    <HBox>
                        <children>
                            <Label text="VAT (12%):" HBox.hgrow="ALWAYS" />
                            <Label fx:id="lblReceiptVAT" text="₱0.00" style="-fx-font-weight: bold;" />
                        </children>
                    </HBox>
                    <Separator />
                    <HBox>
                        <children>
                            <Label text="GRAND TOTAL:" HBox.hgrow="ALWAYS" style="-fx-font-weight: bold;" />
                            <Label fx:id="lblReceiptGrandTotal" text="₱0.00" style="-fx-font-weight: bold; -fx-font-size: 14;" />
                        </children>
                    </HBox>
                    <Separator />
                    <HBox>
                        <children>
                            <Label text="Amount Paid:" HBox.hgrow="ALWAYS" />
                            <Label fx:id="lblReceiptAmountPaid" text="₱0.00" style="-fx-font-weight: bold;" />
                        </children>
                    </HBox>
                    <HBox>
                        <children>
                            <Label text="CHANGE:" HBox.hgrow="ALWAYS" style="-fx-font-weight: bold; -fx-text-fill: green;" />
                            <Label fx:id="lblReceiptChange" text="₱0.00" style="-fx-font-weight: bold; -fx-text-fill: green; -fx-font-size: 14;" />
                        </children>
                    </HBox>
                </children>
            </VBox>
            
            <Separator prefWidth="600" />
            
            <!-- Receipt Footer -->
            <VBox spacing="5" alignment="CENTER">
                <children>
                    <Label text="THANK YOU! COME AGAIN!" style="-fx-font-weight: bold; -fx-font-family: 'Courier New';" />
                    <Label text="This serves as your official receipt" style="-fx-font-family: 'Courier New'; -fx-font-size: 10; -fx-text-fill: #666;" />
                </children>
            </VBox>
            
            <Separator prefWidth="600" />
            
            <!-- Close Button -->
            <Button text="CLOSE" onAction="#handleReceiptClose" prefWidth="200" prefHeight="40"
                    style="-fx-background-color: #92709A; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;" />
        </children>
        
    </VBox>

</StackPane>